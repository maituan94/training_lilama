<!-- AWP_In_Variable Name='"SPEED-IN"' -->
<!-- AWP_In_Variable Name='"DATA_TRANSFER".SPEED_ACTUAL' -->
<!-- AWP_In_Variable Name='"DATA_TRANSFER".FREQUENCY_ACTUAL' -->
<!-- AWP_In_Variable Name='"DATA_TRANSFER".VOLTAGE_ACTUAL' -->
<!-- AWP_In_Variable Name='"DATA_TRANSFER".CURRENT_ACTUAL' -->
<!-- AWP_In_Variable Name='"DATA_TRANSFER".TORQUE_ACTUAL' -->
<!-- AWP_In_Variable Name='"DATA_TRANSFER".TEMPERATURE_ACTUAL' -->
<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script lang="javascript" src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0/dist/Chart.min.js"></script>
    <link rel="stylesheet" href="./css/style.css">
    <script lang="javascript" src="https://cdn.jsdelivr.net/gh/maituan94/training_lilama@master/demo_dt_qt_online/js/particles.min.js"></script>
</head>

<body>
    <div>
        <div class="header">
            <img class="logo" src="http://lilama2.edu.vn/Media/Images/Linkwebsite/lilama2-logo.png" />
            <div class="title">Trường Cao Đẳng Công Nghệ Quốc Tế Lilama 2</div>
        </div>
        <div class="banner">
            <div id="particles-js"><canvas class="particles-js-canvas-el" style="width: 100%; height: 100%;"></canvas>
            </div>
            <div id="content_home" class="content container">
                <div class="title">Ứng Dụng Điều Khiển Động Cơ Trong Ngành Công Nghiệp 4.0</div>
                <div class="orange-line"></div>
                <!-- <div class="text-decription">Bài Tập Phân Loại Sản phẩm</div> -->
                <div class="home_docs_btn">
                    <div class="title_controller">Tốc độ động cơ</div>
                    <div class="row">
                        <div class="col-input-speed col-12 col-md-6">
                            <input id="id_input_speed" class="form-control" placeholder="Nhập tốc độ động cơ..." />
                        </div>
                        <div class="col-input-range col-12 col-md-6">
                            <div class="inside-control div-range">
                                <form>
                                    <div id="Value_Range" class="value">0</div>
                                    <div class="div-inside-range">
                                        <input id="Range_Step" class="range-input" type="range" min="0" max="1350"
                                            step="1" name="SPEED" value="0">
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="col-12 col-button-confirm">
                            <button id="confirm_speed" type="submit" type="button" class=" btn btn-primary">
                                Xác Nhận
                            </button>
                        </div>
                    </div>
                </div>
                <div class="home_docs_btn">
                    <div class="row row-value">
                        <div class="col-12 col-md-6 col-inside">
                            <div class="tab-value">
                                <div class="label-value">Speed: </div>
                                <div id="speed_value" class="value-span">0</div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6 col-inside">
                            <div class="tab-value">
                                <div class="label-value">Frequency: </div>
                                <div id="frequency_value" class="value-span">0</div>
                            </div>
                        </div>
                    </div>
                    <div class="row row-value">
                        <div class="col-12 col-md-6 col-inside">
                            <div class="tab-value">
                                <div class="label-value">Voltage: </div>
                                <div id="voltage_value" class="value-span">0</div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6 col-inside">
                            <div class="tab-value">
                                <div class="label-value">Current: </div>
                                <div id="current_value" class="value-span">0</div>
                            </div>
                        </div>
                    </div>
                    <div class="row row-value">
                        <div class="col-12 col-md-6 col-inside">
                            <div class="tab-value">
                                <div class="label-value">Torque: </div>
                                <div id="torque_value" class="value-span">0</div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6 col-inside">
                            <div class="tab-value">
                                <div class="label-value">Temperature: </div>
                                <div id="temperature_value" class="value-span">0</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="home_docs_btn">
                    <div class="title_controller title_diagram">Biểu đồ tốc độ</div>
                    <div class="row">
                        <div class="col-12 col-lg-6">
                            <div class="label-diagram">Speed</div>
                            <canvas style="width:100%;height:500px;" id="speedChart"></canvas>
                        </div>
                        <div class="col-12 col-lg-6">
                            <div class="label-diagram">Voltage</div>
                            <canvas style="width:100%;height:500px;" id="voltageChart"></canvas>
                        </div>
                    </div>
                    <!-- copy another -->
                    <div class="row">
                        <div class="col-12 col-lg-6">
                            <div class="label-diagram">Current</div>
                            <canvas style="width:100%;height:500px;" id="currentChart"></canvas>
                        </div>
                        <div class="col-12 col-lg-6">
                            <div class="label-diagram">Temperature</div>
                            <canvas style="width:100%;height:500px;" id="temperatureChart"></canvas>
                        </div>

                    </div>
                </div>
            </div>
            <!-- <div id="content_auto" class="content container content_control">
                <div class="title">Auto Controller</div>
                <div class="row-control row">
                    <div style="text-align: right;" class="col-6">
                        <button id="id-auto-start" class="auto-btn btn btn-outline-success">START</button>
                    </div>
                    <div class="col-6">
                        <button id="id-auto-stop" class="auto-btn btn btn-outline-danger">STOP</button>
                    </div>
                </div>
                <div class="row-control row">
                    <div class="col-12 col-md-4 value-auto">
                        <div class="label-auto">Nhựa Đen</div>
                        <div class="real-val" id="value-nhua-den">0</div>
                    </div>
                    <div class="col-12 col-md-4 value-auto">
                        <div class="label-auto">Nhựa Trắng</div>
                        <div class="real-val" id="value-nhua-trang">0</div>
                    </div>
                    <div class="col-12 col-md-4 value-auto">
                        <div class="label-auto">Kim Loại</div>
                        <div class="real-val" id="value-kim-loai">0</div>
                    </div>
                </div>
                <div class="row-control row">
                    <button id="btn_back_auto" style="margin-left:auto;" class="btn btn-outline-secondary">Quay
                        lại</button>
                </div>
            </div>
            <div id="content_manual" class="content container content_control">
                <div class="title">Manual Controller</div>
                <div class="div-xilanh">
                    <div class="label-xilanh">Xy Lanh 1</div>
                    <input id="id-xy-lanh1" type="checkbox" class="switch">
                </div>
                <div class="div-xilanh">
                    <div class="label-xilanh">Xy Lanh 2</div>
                    <input type="checkbox" class="switch">
                </div>
                <div class="div-xilanh">
                    <div class="label-xilanh">Xy Lanh 3</div>
                    <input type="checkbox" class="switch">
                </div>
                <div class="div-xilanh">
                    <div class="label-xilanh">Xy Lanh 4</div>
                    <input type="checkbox" class="switch">
                </div>
                <div class="div-xilanh">
                    <div class="label-xilanh">Xy Lanh 5</div>
                    <input type="checkbox" class="switch">
                </div>
                <div class="row-control row">
                        <button id="btn_back_manual" style="margin-left:auto;" class="btn btn-outline-secondary">Quay
                            lại</button>
                    </div>
            </div> -->
        </div>
    </div>
</body>
<script src="./js/app.js"></script>
<script>
    $(document).ready(function () {

        //INPUT VALUE
        $('#Value_Range').html($('#Range_Step').prop('value'))
        $('#Range_Step').on('input', function (e) {
            $('#Value_Range').html(e.target.value)
            $('#id_input_speed').val(e.target.value)
        });
        $('#Range_Step').change(function () {
            // console.log('Change')
        })
        $('#id_input_speed').on('input', function (e) {
            let value = e.target.value
            let max_value = parseInt($('#Range_Step').prop('max'))
            let min_value = parseInt($('#Range_Step').prop('min'))
            if (value > max_value) {
                $(this).val(max_value)
                $('#Value_Range').html(max_value)
                $('#Range_Step').val(max_value)
            } else if (value < min_value) {
                $(this).val(min_value)
                $('#Value_Range').html(min_value)
                $('#Range_Step').val(min_value)
            } else if (!value) {
                $('#Value_Range').html(0)
                $('#Range_Step').val(0)
            } else {
                $('#Value_Range').html(value)
                $('#Range_Step').val(value)
            }

        })


        // Speed chart
        //note change id and tag <canvas> (example: <canvas id="example" />) and then $('#example')
        //copy change name "ctx_line","config_speed_chart", "mySpeedChart"
        var ctx_speed = $('#speedChart')[0].getContext('2d');
        var config_speed_chart = {
            type: 'line',
            data: {
                // labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                datasets: [{
                    label: '',
                    data: [
                        // 12, 19, 3, 5, 2, 3
                    ],
                    // backgroundColor: [
                    //     'rgba(255, 99, 132, 0.2)',
                    //     'rgba(54, 162, 235, 0.2)',
                    //     'rgba(255, 206, 86, 0.2)',
                    //     'rgba(75, 192, 192, 0.2)',
                    //     'rgba(153, 102, 255, 0.2)',
                    //     'rgba(255, 159, 64, 0.2)'
                    // ],
                    fill: false,
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    // borderColor: [
                    //     'rgba(255, 99, 132, 1)',
                    //     'rgba(54, 162, 235, 1)',
                    //     'rgba(255, 206, 86, 1)',
                    //     'rgba(75, 192, 192, 1)',
                    //     'rgba(153, 102, 255, 1)',
                    //     'rgba(255, 159, 64, 1)'
                    // ],
                    borderColor: 'rgba(153, 102, 255, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                },
                legend: {
                    display: false
                },
                tooltips: {
                    enabled: false
                },
                responsive: false,
                maintainAspectRatio: false,
            }
        }
        var mySpeedChart = new Chart(ctx_speed, config_speed_chart);


        //Voltage Chart
        //note change id and tag <canvas> (example: <canvas id="example" />) and then $('#example')
        //copy change name "ctx_voltage","config_chart_voltage", "myChartVoltage"
        var ctx_voltage = $('#voltageChart')[0].getContext('2d');
        var config_chart_voltage = {
            type: 'line',
            data: {
                // labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                datasets: [{
                    label: '',
                    data: [0
                        // 12, 19, 3, 5, 2, 3
                    ],
                    // backgroundColor: [
                    //     'rgba(255, 99, 132, 0.2)',
                    //     'rgba(54, 162, 235, 0.2)',
                    //     'rgba(255, 206, 86, 0.2)',
                    //     'rgba(75, 192, 192, 0.2)',
                    //     'rgba(153, 102, 255, 0.2)',
                    //     'rgba(255, 159, 64, 0.2)'
                    // ],
                    fill: false,
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    // borderColor: [
                    //     'rgba(255, 99, 132, 1)',
                    //     'rgba(54, 162, 235, 1)',
                    //     'rgba(255, 206, 86, 1)',
                    //     'rgba(75, 192, 192, 1)',
                    //     'rgba(153, 102, 255, 1)',
                    //     'rgba(255, 159, 64, 1)'
                    // ],
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                },
                legend: {
                    display: false
                },
                tooltips: {
                    enabled: false
                },
                responsive: false,
                maintainAspectRatio: false,
            }
        }
        var myChartVoltage = new Chart(ctx_voltage, config_chart_voltage);


        //Current Chart
        //note change id and tag <canvas> (example: <canvas id="example" />) and then $('#example')
        //copy change name "ctx_current","config_chart_current", "myChartCurrent"
        var ctxCurrent = $('#currentChart')[0].getContext('2d');
        var config_chart_current = {
            type: 'line',
            data: {
                // labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                datasets: [{
                    label: '',
                    data: [0
                        // 12, 19, 3, 5, 2, 3
                    ],
                    // backgroundColor: [
                    //     'rgba(255, 99, 132, 0.2)',
                    //     'rgba(54, 162, 235, 0.2)',
                    //     'rgba(255, 206, 86, 0.2)',
                    //     'rgba(75, 192, 192, 0.2)',
                    //     'rgba(153, 102, 255, 0.2)',
                    //     'rgba(255, 159, 64, 0.2)'
                    // ],
                    fill: false,
                    backgroundColor: 'rgba(255, 159, 64, 0.2)',
                    // borderColor: [
                    //     'rgba(255, 99, 132, 1)',
                    //     'rgba(54, 162, 235, 1)',
                    //     'rgba(255, 206, 86, 1)',
                    //     'rgba(75, 192, 192, 1)',
                    //     'rgba(153, 102, 255, 1)',
                    //     'rgba(255, 159, 64, 1)'
                    // ],
                    borderColor: 'rgba(255, 159, 64, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                },
                legend: {
                    display: false
                },
                tooltips: {
                    enabled: false
                },
                responsive: false,
                maintainAspectRatio: false,
            }
        }
        var myChartCurrent = new Chart(ctxCurrent, config_chart_current);



        //Temperature Chart
        //note change id and tag <canvas> (example: <canvas id="example" />) and then $('#example')
        //copy change name "ctx_Temperature","config_chart_temperature", "myChartTemperature"
        var ctx_Temperature = $('#temperatureChart')[0].getContext('2d');
        var config_chart_temperature = {
            type: 'line',
            data: {
                // labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                datasets: [{
                    label: '',
                    data: [
                        // 12, 19, 3, 5, 2, 3
                    ],
                    // backgroundColor: [
                    //     'rgba(255, 99, 132, 0.2)',
                    //     'rgba(54, 162, 235, 0.2)',
                    //     'rgba(255, 206, 86, 0.2)',
                    //     'rgba(75, 192, 192, 0.2)',
                    //     'rgba(153, 102, 255, 0.2)',
                    //     'rgba(255, 159, 64, 0.2)'
                    // ],
                    fill: false,
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    // borderColor: [
                    //     'rgba(255, 99, 132, 1)',
                    //     'rgba(54, 162, 235, 1)',
                    //     'rgba(255, 206, 86, 1)',
                    //     'rgba(75, 192, 192, 1)',
                    //     'rgba(153, 102, 255, 1)',
                    //     'rgba(255, 159, 64, 1)'
                    // ],
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                },
                legend: {
                    display: false
                },
                tooltips: {
                    enabled: false
                },
                responsive: false,
                maintainAspectRatio: false,
            }
        }
        var myChartTemperature = new Chart(ctx_Temperature, config_chart_temperature);


        //get value from api.io
        setInterval(function () {
            $.get(window.location.origin + "/awp/api.io", function (response) {

                // assign value
                let value_all = JSON.parse(response)
                let val_speed = parseFloat(value_all.speed).toFixed(1)
                let val_frequency = parseFloat(value_all.frequency).toFixed(1)
                let val_voltage = parseFloat(value_all.voltage).toFixed(2)
                let val_current = parseFloat(value_all.current).toFixed(2)
                let val_torque = parseFloat(value_all.torque).toFixed(1)
                let val_temperature = parseFloat(value_all.temperature).toFixed(1)

                //set value
                $('#speed_value').html(value_all.speed)
                $('#frequency_value').html(value_all.frequency)
                $('#voltage_value').html(value_all.voltage)
                $('#current_value').html(value_all.current)
                $('#torque_value').html(value_all.torque)
                $('#temperate_value').html(value_all.temperature)

                //speed chart
                let speed_to_chart = val_speed;
                let date_speed = new Date()
                config_speed_chart.data.labels.push(date_speed.getHours() + ":" + date_speed.getMinutes() + ":" + date_speed.getSeconds());
                config_speed_chart.data.datasets[0].data.push(speed_to_chart);
                let length_speed = config_speed_chart.data.datasets[0].data.length
                if (length_speed > 25) {
                    config_speed_chart.data.labels.splice(0, 1)
                    config_speed_chart.data.datasets[0].data.splice(0, 1);
                }
                mySpeedChart.update();

                //voltage chart

                let voltage_to_chart = val_voltage;
                let date_vol = new Date()
                config_chart_voltage.data.labels.push(date_vol.getHours() + ":" + date_vol.getMinutes() + ":" + date_vol.getSeconds());
                config_chart_voltage.data.datasets[0].data.push(voltage_to_chart);
                let length_vol = config_chart_voltage.data.datasets[0].data.length
                if (length_vol > 25) {
                    config_chart_voltage.data.labels.splice(0, 1)
                    config_chart_voltage.data.datasets[0].data.splice(0, 1);
                }
                myChartVoltage.update();

                //Current Chart
                let current_to_chart = val_current;
                let date_current = new Date()
                config_chart_current.data.labels.push(date_current.getHours() + ":" + date_current.getMinutes() + ":" + date_current.getSeconds());
                config_chart_current.data.datasets[0].data.push(current_to_chart);
                let length_current = config_chart_current.data.datasets[0].data.length
                if (length_current > 25) {
                    config_chart_current.data.labels.splice(0, 1)
                    config_chart_current.data.datasets[0].data.splice(0, 1);
                }
                myChartCurrent.update();

                //temperature chart
                let temperature_to_chart = val_temperature;
                let date_temp = new Date()
                config_chart_temperature.data.labels.push(date_temp.getHours() + ":" + date_temp.getMinutes() + ":" + date_temp.getSeconds());
                config_chart_temperature.data.datasets[0].data.push(temperature_to_chart);
                let length_temp = config_chart_temperature.data.datasets[0].data.length
                if (length_temp > 25) {
                    config_chart_temperature.data.labels.splice(0, 1)
                    config_chart_temperature.data.datasets[0].data.splice(0, 1);
                }
                myChartTemperature.update();
            })
        }, 250)

    })
</script>
<script>
    var url = window.location.pathname
    $('#confirm_speed').click(function () {
        let value = $('#id_input_speed').val()
        $.get(url + '?"SPEED-IN="' + value, function () {

        })
    })
</script>

</html>